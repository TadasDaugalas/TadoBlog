<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/fragments :: head(#{com.example.tadoblog.readmore.title})"></head>
<body>
<header th:insert="fragments/fragments :: navigation"></header>
<main>
    <div class="container">

        <div class="container">
            <div class="col background-white py-3">
                <div class="clearfix">
                    <img th:src="@{/img/tropical-Fish.jpg}" class="col-md-4 mb-3 ms-md-3 rounded float-sm-start"
                         alt="...">
                    <p th:text="${readMore.cardText}"></p>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="input-group mb-3">
                <form th:method="post" th:object="${comment}"
                      th:action="@{/cards/readMore/{id}/addComment(id=${readMore.id})}">
                    <input type="text"
                           class="form-control"
                           placeholder="Recipient's username"
                           th:field="*{commentText}">
                    <button class="btn btn-outline-secondary" type="submit" id="button-addon2">Add Comment</button>
                </form>
            </div>

            Comments
            <div th:each="comment : ${readMore.comments}" th:if="${comment.getParentComment() == null}">
                <div th:text="${comment.commentText}"></div>
                <a th:if="${comment.getUser().getId().equals(currentUserId) && !comment.getId().equals(editComment)}" th:href="@{/cards/readMore/{id}/editComment/{commentId}(id=${readMore.id},commentId=${comment.id})}" type="button" class="btn btn-light">Edit</a>
                <form th:if="${comment.getId().equals(editComment)}" th:method="post" th:object="${comment}"
                      th:action="@{/cards/readMore/{id}/editComment/{commentId}(id=${readMore.id},commentId=${comment.id})}">
                    <input type="text"
                           class="form-control"
                           th:field="*{commentText}">
                    <button class="btn btn-outline-secondary" type="submit" id="button-addona">Save</button>
                </form>
                <div class="ps-5"
                     th:each="childComment : ${readMore.comments}"
                     th:if="${childComment.getParentComment() != null && childComment.getParentComment().getId().equals(comment.getId())}"
                     th:text="${childComment.commentText}">
                </div>


<!--                <button type="button" class="btn btn-light">Reply</button>-->
<!--                <form th:method="post" th:object="${comment}"-->
<!--                      th:action="@{/cards/readMore/{id}/addComment/{commentId}(id=${readMore.id},commentId=${comment.id})}">-->
<!--                    <input type="text"-->
<!--                           class="form-control"-->
<!--                           placeholder="Recipient's username"-->
<!--                           th:field="*{commentText}">-->
<!--                    <button class="btn btn-outline-secondary" type="submit" id="button-addon">Reply</button>-->
<!--                </form>-->
            </div>
        </div>
    </div>
</main>
<footer th:replace="fragments/fragments :: footer"></footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>
</html>